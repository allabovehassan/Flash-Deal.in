<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User</title>
    <link rel="stylesheet" href="../CSS/footer.css">
    <link rel="stylesheet" href="../CSS/header.css">
    <link rel="stylesheet" href="../CSS/userPage.css">
    <link rel="icon" type="image/x-icon" href="../IMAGES/FlashDeal_icon-removebgcrped.png">
</head>
<body>
    
    <header>
      <div id="headerChild2">
        <div id="hc21" onclick="window.location.href='../index.html'">
          <img src="../IMAGES/Flash_Deal_Logonew.png" alt="flash deal logo" />
        </div>

        <div id="hc22">
          <div id="hc221">
            <div id="cityname">
              <img src="../IMAGES/pin.png" alt="" />
            </div>

            <div id="cityform">
              <select name="city" id="city">
                <option value="volvo"></option>
                <option value="volvo">Delhi</option>
                <option value="saab">Mumbai</option>
                <option value="mercedes">Banglore</option>
                <option value="audi">Chennai</option>
              </select>
            </div>
          </div>
          <div id="hc222">
            <div id="insearch">
              <input
                type="search"
                id="searchpro"
                placeholder="Enter Products"
              />
            </div>
            <div id="insubmit">
              <img src="../IMAGES/searchwhite.png" alt="search" />
            </div>
          </div>
        </div>

        <div id="hc23">
          <div id="hc231">
            <div id="adminlogo">
              <img src="../IMAGES/avatar.png" alt="" />
            </div>
            <div id="logdiv">
              <!-- <p onclick="document.getElementById('id01').style.display='block'" >
                Login/Register
              </p> -->
            </div>
          </div>
          <div id="hc232" onclick="window.location.href='./ad_post_page.html'">
            <p>Post Free Ad</p>
          </div>
        </div>
      </div>

    </header>
    
    <!-- <hr /> -->

    <h3>My Account</h3>
    <div id="userbox">

        

        
    </div>
    <h3 >My Ads</h3>

    <div id="refresh" onclick="fetchad()">
     REFRESH
    </div>


    <div id="userbox2">




    </div>

<!-- --------------------------------- -->
    <footer >
      <div id="f1" style="border-right: 0.5px solid lightgray">
        <div id="f11">
          <a href="">About Us</a>
          <a href="">Contact Us</a>
          <a href="">Flash Deal Videos</a>
          <a href="">Advertise With Us</a>
          <a href="">Blog</a>
        </div>
        <div id="f12">
          <p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Tempore
            ipsam ratione officiis perferendis nobis ad libero, totam esse
            excepturi mollicdtia, accusamus sit laboriosam voluptas quo
            consectetur voluptatem facere eaque fugit unde. Architecto quod
            nulla minima quas ipsam eos recusandae cupiditate. Qui eveniet
            officiis ducimus veniam .
          </p>
        </div>
        <!-- <div id="f13">
          <span
            >At Flash Deal, you can buy, sell or rent anything you can think of.
          </span>
          <div onclick="window.location.href='./HTML/ad_post_page.html'">
            <p>Post Free Ad</p>
          </div>
        </div> -->

          <div id="f13">
          <span
            >At Flash Deal, you can buy, sell or rent anything you can think of.
          </span>
          <div onclick="window.location.href='./HTML/ad_post_page.html'" style="margin-right:35% ;">
            <p>Post Free Ad</p>
          </div>
          <div id="logout" style="margin-left: -30%; margin-right: 10%; display: flex; justify-content: center; align-items: center;" onclick="logoutfun()">
            Logout
          </div>
        </div>


      </div>
      <div id="f2">
        <div id="f211">
          <div class="f2icon">
            <p>Follow Us</p>
          </div>
          <div class="f2icon">
            <img src="../IMAGES/facebook.png" alt="" />
          </div>
          <div class="f2icon">
            <img src="../IMAGES/linkedin.png" alt="" />
          </div>
          <div class="f2icon"><img src="../IMAGES/youtube.png" alt="" /></div>
          <div class="f2icon"><img src="../IMAGES/twitter.png" alt="" /></div>
          <div class="f2icon">
            <img src="../IMAGES/google-plus.png" alt="" />
          </div>
        </div>
        <nav>
          <div class="navc">
            <p>Download App</p>
          </div>
          <div class="navc">
            <img src="../IMAGES/apple-logo.png" alt="" />
          </div>
          <div class="navc">
            <img src="../IMAGES/play-store.png" alt="" />
          </div>
        </nav>
      </div>
    </footer>

    <div id="last">
      Copyright Â© 2008 - 2023 Flash Deal India Private Limited
    </div>

</body>
</html>
<script>
    // window.location.reload()
let login_Username = localStorage.getItem("lname")
 let login_Useremail = localStorage.getItem("lemail")
  let login_Userage = localStorage.getItem("lage")
  
    let token = localStorage.getItem("token")


  function fetchad(){
    fetchUserAds()
    fetchUserAds2()
    // window.location.reload()
  }




let box= document.querySelector("#userbox")
    box.innerHTML=`
        
            <div id="userbox_1">
                <img src="../IMAGES/humanboy.png" alt="">
            </div>
            <div id="userbox_2">
                <h3>Name:-${login_Username}</h3>
                <h3>Email:-${login_Useremail}</h3>
                <h3>Age:-${login_Userage}</h3>
                <h3>Password:-XXXXXX</h3>

            </div>


            <div id="userbox_3" onclick="window.location.href='./userPatch.html'">


                <p>EDIT</p>
                <img src="../IMAGES/pen.png" alt="">


            </div>
        
        
    `
  console.log(login_Username)

  let xname=""

  if(!login_Username){
    xname="Login/Register"
  }else{
    xname=login_Username
  }
        
      

let userlogo = document.querySelector("#adminlogo")



// userlogo.innerHTML = `
//        ${xlogo.innerHTML}


// `

let xlogo = `<img src="./IMAGES/avatar.png" alt="" />`

if(login_Username===null){

}else{
  // xlogo=`<img src="./IMAGES/avatar.png" alt="" /> onclick="window.location.href="./HTML/User_Page.html""`
  userlogo.addEventListener("click",()=>{
  window.location.href="./User_Page.html"
})
}


let logbox = document.querySelector("#logdiv")

logbox.innerHTML=`
  <p onclick="document.getElementById('id01').style.display='block'" >${xname}</p>

`

// -------------------------------------------------------------------

function logoutfun(){
  alert("Logout Sucessfull")
  window.location.href="../index.html"
  localStorage.clear()
}

// -------------------------------------------------

let login_id = localStorage.getItem("lid")


let my_car_ad_url = "http://localhost:8080/car/myads/"+login_id

async function fetchUserAds(){

try {
  let res = await fetch(my_car_ad_url,{
    headers:{
      "token":token
    }
  })
    let data = await res.json()
  display(data)
  console.log(data)
  // console.log(my_car_ad_url)
    
  } catch (error) {
    
    alert(data.message)
    
  
}


}

let my_mobile_ad_url = "http://localhost:8080/mobile/myads/"+login_id

async function fetchUserAds2(){

try {
  let res = await fetch(my_mobile_ad_url,{
    headers:{
      "token":token
    }
  })
    let data = await res.json()
  display(data)
  console.log(data)
  // console.log(my_mobile_ad_url)
    
  } catch (error) {
    
    alert(data.message)
    
  
}


}


function display(elem){

        let div=document.querySelector("#userbox2");
        div.innerHTML=""
        div.innerHTML+=elem.map(e => {
            return `
            <div class="innderdiv" >
            <B>Title</B> : <em>${e.title}</em> 
            <hr>
            <B>Model</B> : <em>${e.model}</em>
            <hr>
            <B>Year</B> : <em>${e.year}</em>
            <hr>
            <B>Owner</B> : <em>${e.owner}</em>
            <hr>
            <B>Year</B> : <em>${e.price}</em>
            <hr>
            <B>Contact</B> : <em>${e.contact}</em>
            
            <hr>
            <button onclick=deleteit("${e._id}") style="width: 30%"; margin-left: 20%;">Delete</button>
            <button onclick=updateit("${e._id}") style="width: 30%;">Update</button>
            <hr>

            </div>`
        }).join("");
    }


</script>