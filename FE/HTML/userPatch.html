<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Details Update</title>
     <link rel="stylesheet" href="../CSS/footer.css">
    <link rel="stylesheet" href="../CSS/header.css">
    <link rel="stylesheet" href="../CSS/updateuser.css">
     <link rel="icon" type="image/x-icon" href="../IMAGES/FlashDeal_icon-removebgcrped.png">
</head>
<body>
    <header>
      <div id="headerChild2">
        <div id="hc21" onclick="window.location.href='../index.html'">
          <img src="../IMAGES/Flash_Deal_Logonew.png" alt="flash deal logo" />
        </div>

        <div id="hc22">
          <div id="hc221">
            <div id="cityname">
              <img src="../IMAGES/pin.png" alt="" />
            </div>

            <div id="cityform">
              <select name="city" id="city">
                <option value="volvo"></option>
                <option value="volvo">Delhi</option>
                <option value="saab">Mumbai</option>
                <option value="mercedes">Banglore</option>
                <option value="audi">Chennai</option>
              </select>
            </div>
          </div>
          <div id="hc222">
            <div id="insearch">
              <input
                type="search"
                id="searchpro"
                placeholder="Enter Products"
              />
            </div>
            <div id="insubmit">
              <img src="../IMAGES/searchwhite.png" alt="search" />
            </div>
          </div>
        </div>

        <div id="hc23">
          <div id="hc231">
            <div id="adminlogo">
              <img src="../IMAGES/avatar.png" alt="" />
            </div>
            <div id="logdiv">
              <!-- <p onclick="document.getElementById('id01').style.display='block'" >
                Login/Register
              </p> -->
            </div>
          </div>
          <div id="hc232" onclick="window.location.href='./ad_post_page.html'">
            <p>Post Free Ad</p>
          </div>
        </div>
      </div>

    </header>

    <!-- <hr /> -->
    <h3>Update Your Details</h3>

        <div id="updatebox">


        <form id="update_user_form">
            <label for="name"></label><br>
            <input type="text" id="name" name="name" value="" placeholder="Enter Name">
            <br>
            
            
            
            <label for="email"></label><br>
            <input type="text" id="email" name="email" value="" placeholder="Enter Email">
            <br>
            
            
            <label for="age"></label><br>
            <input type="text" id="age" name="age" value="" placeholder="Enter Age">
            <br>
            
            
            <label for="psw"></label><br>
            <input type="password" id="psw" name="psw" value="" placeholder="Confirm Password">
            <br>
            
            <br>
            <br>
            
            <input type="submit" id="submit" value="Update">
            



        </form>



        </div>
    <!-- ---------------------------------------------------------------- -->

    <footer >
      <div id="f1" style="border-right: 0.5px solid lightgray">
        <div id="f11">
          <a href="">About Us</a>
          <a href="">Contact Us</a>
          <a href="">Flash Deal Videos</a>
          <a href="">Advertise With Us</a>
          <a href="">Blog</a>
        </div>
        <div id="f12">
          <p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit. Tempore
            ipsam ratione officiis perferendis nobis ad libero, totam esse
            excepturi mollicdtia, accusamus sit laboriosam voluptas quo
            consectetur voluptatem facere eaque fugit unde. Architecto quod
            nulla minima quas ipsam eos recusandae cupiditate. Qui eveniet
            officiis ducimus veniam .
          </p>
        </div>
        <div id="f13">
          <span
            >At Flash Deal, you can buy, sell or rent anything you can think of.
          </span>
          <div onclick="window.location.href='./HTML/ad_post_page.html'" style="margin-right:35% ;">
            <p>Post Free Ad</p>
          </div>
          <div id="logout" style="margin-left: -30%; margin-right: 10%; display: flex; justify-content: center; align-items: center;" onclick="logoutfun()">
            Logout
          </div>
        </div>
      </div>
      <div id="f2">
        <div id="f211">
          <div class="f2icon">
            <p>Follow Us</p>
          </div>
          <div class="f2icon">
            <img src="../IMAGES/facebook.png" alt="" />
          </div>
          <div class="f2icon">
            <img src="../IMAGES/linkedin.png" alt="" />
          </div>
          <div class="f2icon"><img src="../IMAGES/youtube.png" alt="" /></div>
          <div class="f2icon"><img src="../IMAGES/twitter.png" alt="" /></div>
          <div class="f2icon">
            <img src="../IMAGES/google-plus.png" alt="" />
          </div>
        </div>
        <nav>
          <div class="navc">
            <p>Download App</p>
          </div>
          <div class="navc">
            <img src="../IMAGES/apple-logo.png" alt="" />
          </div>
          <div class="navc">
            <img src="../IMAGES/play-store.png" alt="" />
          </div>
        </nav>
      </div>
    </footer>

    <div id="last">
      Copyright Â© 2008 - 2023 Flash Deal India Private Limited
    </div>


</body>
</html>
<script>




 let login_Username = localStorage.getItem("lname")
  console.log(login_Username)
  let login_id = localStorage.getItem("lid")
  console.log(login_id)

    let token = localStorage.getItem("token")

  let xname=""

  if(!login_Username){
    xname="Login/Register"
  }else{
    xname=login_Username
  }
        
      

let userlogo = document.querySelector("#adminlogo")



// userlogo.innerHTML = `
//        ${xlogo.innerHTML}


// `

let xlogo = `<img src="./IMAGES/avatar.png" alt="" />`

if(login_Username===null){

}else{
  // xlogo=`<img src="./IMAGES/avatar.png" alt="" /> onclick="window.location.href="./HTML/User_Page.html""`
  userlogo.addEventListener("click",()=>{
  window.location.href="./User_Page.html"
})
}


let logbox = document.querySelector("#logdiv")

logbox.innerHTML=`
  <p onclick="document.getElementById('id01').style.display='block'" >${xname}</p>

`






let formdata = document.querySelector("form")

document.querySelector("#submit").addEventListener("click",updateUser)

let update_url = "http://localhost:8080/user/update/"+login_id


function updateUser(e){
  e.preventDefault()
  
  let obj = {}
    if(formdata.name.value) obj.name=formdata.name.value
    if(formdata.email.value) obj.email=formdata.email.value
    // if(formdata.psw.value) obj.pass=formdata.psw.value
    if(formdata.age.value) obj.age=formdata.age.value

    // name:document.querySelector("#name").value,
    // email:document.querySelector("#email").value,
    // pass:document.querySelector("#psw").value,
    // age:document.querySelector("#age").value



  console.log(obj)
  updateconnect(obj)

}
async function updateconnect(obj){

    try {
        let res = await fetch(update_url,{
            method:"PATCH",
            headers:{
                "Content-Type":"application/json",
                "token":token
            },
            body:JSON.stringify(obj)
        })
        let data = await res.json()
        if(data.message==="User Details Updated"){
          alert(data.message);
        //   window.location.href="../index.html"
        }else{
            alert(data.message)
        }
    } catch (error) {
        console.log(error.message)
        alert(data.message)
    }  


}

function logoutfun(){
  alert("Logout Sucessfull")
  window.location.href="../index.html"
  localStorage.clear()
}



</script>